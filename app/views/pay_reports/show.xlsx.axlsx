wb = xlsx_package.workbook

wb.add_worksheet(name: "Payroll") do |sheet|

	sheet.add_row ["Lloyds \n Cabinetry and Countertops"]
	sheet.add_row [""	,""					,"Payroll Report"]
	sheet.add_row [""	,"","Period Starting:"	,@pay_report.start]
	sheet.add_row [""	,"","Period Ending:"	,@pay_report.end]
	sheet.add_row 
	sheet.add_row ["Employee"	,"Reg/OT","Total\nHours"		, "Rate"		, "TOTAL GROSS"]

	@users_entries.each do |tasks|
 	hours = 0
 	ot = 0
	 	tasks.each do |entry|
	 		sheet.add_row ["#{entry.task.title}"]

	 		hours += entry.hours.to_f
	 		ot += entry.overtime.to_f
	 	end
	 	if tasks.first
	 		puts "this ran"
	 	sheet.add_row [tasks.first.time_entry.user.full_name,"Regular",hours.to_f / 100,tasks.first.time_entry.user.wage.to_f / 100, (hours*tasks.first.time_entry.user.wage.to_f) / 10000 ]
	 	sheet.add_row ["","overtime",ot / 100,tasks.first.time_entry.user.wage.to_f * 1.5 / 100, ot * tasks.first.time_entry.user.wage.to_f * 1.5 / 10000]
	 	sheet.add_row 
	 	sheet.add_row ["","","","Total",((ot * tasks.first.time_entry.user.wage.to_f * 1.5) + (hours*tasks.first.time_entry.user.wage.to_f)) / 10000]
	 	sheet.add_row 
	else
		sheet.add_row["report error"]
	end

end
end